xdp_pass: xdp_pass.o
#	bpftool net detach xdpgeneric dev enp0s10
	rm -f /sys/fs/bpf/xdp_pass
#	bpftool prog load xdp_pass.o /sys/fs/bpf/xdp_pass
#	bpftool net attach xdpgeneric pinned /sys/fs/bpf/xdp_pass dev enp0s10

xdp_pass.o: xdp_pass.c
	clang -S \
	    -target bpf \
	    -D __BPF_TRACING__ \
	    -I../../lib/libbpf/src\
	    -std=gnu11 \
	    -Wall \
	    -Wno-pointer-sign \
	    -Wno-compare-distinct-pointer-types \
	    -O2 -emit-llvm -c -o ${@:.o=.ll} $<
	llc -march=bpf -filetype=obj -o $@ ${@:.o=.ll}

#	    -Wunused-but-set-variable
#	    -Werror
#	    -Wno-unused-value

clean:
#	bpftool net detach xdpgeneric dev enp0s10
	rm -f /sys/fs/bpf/xdp_pass
	rm xdp_pass.o
	rm xdp_pass.ll
